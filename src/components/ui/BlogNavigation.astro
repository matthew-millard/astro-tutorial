---
import { Icon } from "astro-icon/components";
import { getCollection } from "astro:content";

const blog = await getCollection("blog");
const sortedBlogPosts = blog.sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);

const currentPostIndex = sortedBlogPosts.findIndex(
  (post) => post.id === Astro.params.slug
);
const previousPost =
  currentPostIndex > 0 ? sortedBlogPosts[currentPostIndex - 1] : undefined;
const nextPost =
  currentPostIndex < sortedBlogPosts.length - 1
    ? sortedBlogPosts[currentPostIndex + 1]
    : undefined;
---

{
  (previousPost || nextPost) && (
    <nav class="pagination-links">
      {previousPost && (
        <span class="pagination-link-container mr-auto">
          <Icon name="arrow-left" class="pagination-link__arrow" />
          <a
            href={`/posts/${previousPost.id}`}
            class="pagination-link truncate"
          >
            {previousPost.data.title}
          </a>
        </span>
      )}
      {nextPost && (
        <span class="pagination-link-container ml-auto">
          <a href={`/posts/${nextPost.id}`} class="pagination-link truncate">
            {nextPost.data.title}
          </a>
          <Icon name="arrow-right" class="pagination-link__arrow" />
        </span>
      )}
    </nav>
  )
}

<style>
  .pagination-links {
    display: flex;
    justify-content: space-between;
    gap: 1rem;
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid var(--color-border);
  }

  .pagination-link-container {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    max-width: 45%;
    min-width: 0;
  }

  .pagination-link {
    font-size: var(--step-0);
    font-weight: var(--font-medium);
    min-width: 0;
  }

  .pagination-link__arrow {
    flex-shrink: 0;
  }
</style>
